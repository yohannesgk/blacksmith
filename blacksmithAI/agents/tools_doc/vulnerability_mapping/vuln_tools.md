# Vulnerability Mapping Tools Documentation

This document provides comprehensive technical documentation for vulnerability mapping tools used in cybersecurity assessments. Each tool section includes description, syntax, options, examples, and best practices.

## 1. NUCLEI

### Description
Nuclei is a fast, template-based vulnerability scanner that enables automated security testing across multiple targets. It uses YAML-based templates to define vulnerability checks and supports a wide range of protocols including HTTP, DNS, TCP, and more. Nuclei is highly extensible, allowing security researchers to create and share custom detection templates through the Nuclei Templates repository. default templates are in /root/nuclei-templates. you don't need to specify template path during scan (nuclei -u http://example.com - is enough for basic scan where nuclei automatically uses templates in /root/nuclei-templates) unless you want to use custom templates.


### Basic Syntax

```bash
nuclei [flags] [target]
```

### Available Options

#### Target Options

| Option | Description |
|--------|-------------|
| `-u`, `--target` | Target URL/Domain to scan |
| `-l`, `--list` | File containing list of targets to scan |
| `-i`, `--input` | Input file in specific format (nmap, openvas, etc.) |

#### Template Options

| Option | Description |
|--------|-------------|
| `-t`, `--templates` | Templates or template directory to run |
| `-t`, `--template-url` | URL to download templates from |
| `-w`, `--workflows` | Workflows to run |
| `-val`, `--validate` | Validate templates |
| `-nt`, `--new-templates` | Run only new templates added since last update |
| `-ntv`, `--new-templates-version` | New templates version to run |
| `-r`, `--remote` | Allow remote templates (disabled by default) |
| `--exclude` | Templates to exclude from scan |
| `--include-templates` | Include templates from directory |

#### Severity Options

| Option | Description |
|--------|-------------|
| `-s`, `--severity` | Filter templates by severity (info, low, medium, high, critical) |
| `-tags` | Filter templates by tags |
| `-etag` | Filter templates by etag |
| `-id` | Filter templates by template IDs |

#### Output Options

| Option | Description |
|--------|-------------|
| `-o`, `--output` | Output file to write results |
| `-jsonl` | Write output in JSONL (JSON Lines) format |
| `-csv` | Write output in CSV format |
| `-markdown` | Write output in Markdown format |
| `-sarif` | Write output in SARIF format |
| `-silent` | Suppress extra output |
| `-v`, `--verbose` | Show verbose output |
| `-stats` | Show scan statistics |
| `-profile` | Use specific profile |
| `-mp`, `--metrics-port` | Port to serve metrics on |

#### Runtime Options

| Option | Description |
|--------|-------------|
| `-c`, `--concurrency` | Number of templates to run concurrently (default: 25) |
| `-rate-limit` | Maximum requests per second (default: 150) |
| `-bulk-size` | Bulk size for each template (default: 25) |
| `-headless` | Enable headless browser based scanning |
| `-headless-bulk-size` | Number of headless targets to scan at once |
| `-timeout` | Timeout per request in seconds (default: 5) |
| `-retries` | Number of retries for failed requests (default: 0) |
| `--max-host-error` | Max errors for a host before skipping |
| `--project` | Use a project folder to avoid sending same data |
| `--project-path` | Path to project folder |
| `--stop-at-first-match` | Stop after first match |
| `--no-color` | Disable output colors |
| `--proxy` | HTTP proxy to use |
| `-proxy-url` | Proxy URL |
| `-evn` | Environment variables to use |
| `-H`, `--header` | Custom header to include in requests |

#### Authentication Options

| Option | Description |
|--------|-------------|
| `-token` | Authentication token for template download |
| `-config` | Configuration file path |

### Examples

**Basic scan:**
```bash
nuclei -u http://example.com
```

**Scan multiple targets from file:**
```bash
nuclei -l targets.txt
```

**Scan with specific templates:**
```bash
nuclei -u http://example.com -t cves/
```

**Scan with severity filter:**
```bash
nuclei -u http://example.com -s critical,high
```

**Scan with custom wordlist:**
```bash
nuclei -u http://example.com -t files/ -w /path/to/wordlist.txt
```
note: /path/to/wordlist.txt must exist for the above to work. must be valid location.


**Save output to JSON:**
```bash
nuclei -u http://example.com -o results.json -jsonl
```

**Headless browser scanning:**
```bash
nuclei -u http://example.com --headless -t headless/
```

**Scan with proxy:**
```bash
nuclei -u http://example.com --proxy http://127.0.0.1:8080
```

**Validate templates:**
```bash
nuclei -validate -t cves/CVE-2023-0001.yaml
```

**Workflow-based scanning:**
```bash
nuclei -u http://example.com -w workflows/wordpress.yaml
```
note: workflows/wordpress.yaml must exist for the above to work.
**Rate-limited scanning:**
```bash
nuclei -u http://example.com -rate-limit 50
```

### Best Practices

1. Keep nuclei templates updated regularly for the latest vulnerability checks
2. Use severity filtering to focus on critical and high-severity issues first
3. Use `-headless` for vulnerabilities requiring JavaScript execution
4. Combine with other tools like Nmap for comprehensive scanning
5. Use `--project` for large-scale scans to avoid duplicate work
6. Set appropriate rate limits to avoid overwhelming targets
7. Use `--stop-at-first-match` for faster initial reconnaissance
8. Use workflows to chain related vulnerability checks
9. Save output in JSONL format for programmatic parsing
10. Review and customize templates for your specific environment

---

## 2. SSLSCAN

### Description
SSLscan is a fast SSL/TLS scanner that evaluates SSL/TLS configurations and detects cryptographic weaknesses. It connects to a target SSL/TLS service, determines the supported cipher suites, protocols, and security parameters, and reports vulnerabilities such as weak ciphers, expired certificates, and misconfigurations. It is essential for assessing the security posture of SSL/TLS implementations.

### Basic Syntax

```bash
sslscan [options] target
```

### Available Options

| Option | Description |
|--------|-------------|
| `--target=host[:port]` | Target host and optional port (default: 443) |
| `--port=port` | Specify port number |
| `--ip=address` | Directly connect to IP address (skip DNS) |
| `--ssl2` | Only check SSLv2 ciphers |
| `--ssl3` | Only check SSLv3 ciphers |
| `--tls10` | Only check TLSv1.0 ciphers |
| `--tls11` | Only check TLSv1.1 ciphers |
| `--tls12` | Only check TLSv1.2 ciphers |
| `--tls13` | Only check TLSv1.3 ciphers |
| `--show-ciphers` | Show list of ciphers |
| `--show-certificate` | Show certificate information |
| `--show-client-ciphers` | Show supported client ciphers |
| `--show-sizes` | Show cipher key lengths |
| `--no-check-certificate` | Don't verify certificate chain |
| `--certificate-info` | Show detailed certificate information |
| `--cacert` | Use custom CA certificate file |
| `--pk=file` | Use private key file for testing |
| `--pk-pass=pass` | Password for private key |
| `--starttls` | Use STARTTLS for SMTP/FTP/IMAP/POP3/LDAP |
| `--sni-name=name` | Use Server Name Indication |
| `--timeout` | Connection timeout in seconds |
| `--version` | Show version information |
| `-h`, `--help` | Show help message |
| `--verbose` | Verbose output |
| `--xml=file` | Output results to XML file |
| `--json=file` | Output results to JSON file |
| `--no-colour` | Disable color output |
| `--no-cipher-details` | Hide cipher details |
| `--show-times` | Show connection times |

### STARTTLS Options

| Protocol | Usage |
|----------|-------|
| `smtp` | SMTP with STARTTLS |
| `ftp` | FTP with STARTTLS |
| `imap` | IMAP with STARTTLS |
| `pop3` | POP3 with STARTTLS |
| `ldap` | LDAP with STARTTLS |

### Examples

**Basic SSL/TLS scan:**
```bash
sslscan example.com
```

**Check specific port:**
```bash
sslscan example.com:8443
```

**Show detailed certificate information:**
```bash
sslscan --show-certificate example.com
```

**Check only TLSv1.2 and TLSv1.3:**
```bash
sslscan --tls12 --tls13 example.com
```

**Check for SSLv3 (deprecated):**
```bash
sslscan --ssl3 example.com
```

**STARTTLS scan for SMTP:**
```bash
sslscan --starttls=smtp mail.example.com
```

**Direct IP connection with SNI:**
```bash
sslscan --ip=192.168.1.100 --sni-name=example.com
```

**Save output to JSON:**
```bash
sslscan --json=results.json example.com
```

**Save output to XML:**
```bash
sslscan --xml=results.xml example.com
```

**Verbose output:**
```bash
sslscan --verbose example.com
```

**Custom CA certificate:**
```bash
sslscan --cacert=/path/to/ca.crt example.com
```

**Check weak ciphers:**
```bash
sslscan --show-ciphers example.com | grep -i "rc4\|md5\|export"
```

### Best Practices

1. Always check for deprecated protocols (SSLv2, SSLv3, TLSv1.0, TLSv1.1)
2. Look for weak ciphers (RC4, MD5, 3DES,EXPORT ciphers)
3. Verify certificate chain validation with `--no-check-certificate` disabled
4. Check certificate expiration dates and key lengths
5. Use `--tls13` to check for TLS 1.3 support
6. Use STARTTLS options for services like SMTP/IMAP
7. Use SNI for hosts serving multiple certificates
8. Save output in JSON/XML for programmatic processing
9. Compare results over time to track improvements
10. Focus on findings that affect multiple hosts for organization-wide fixes

---

## General Vulnerability Mapping Best Practices

### 1. Methodology

1. **Pre-scan preparation**: Update tools and define scope clearly
2. **Initial discovery**: Identify targets and attack surface
3. **Service identification**: Determine running services and versions
4. **Vulnerability scanning**: Use appropriate tools for each service type
5. **Validation**: Manually verify critical findings
6. **Documentation**: Record all findings with evidence
7. **Prioritization**: Rank vulnerabilities by severity and impact

### 2. Tool Integration

```bash
# Comprehensive vulnerability scanning workflow
nmap -sV -sC target.com | tee nmap_results.xml
nuclei -target.com -s critical,high -o nuclei_results.jsonl
sslscan target.com | tee sslscan_results.txt

# Parse and correlate results
grep -h "CVE" *.txt *.jsonl | sort -u
```

### 3. Output Management

1. Use JSON format for machine parsing and correlation
2. Implement standardized naming conventions for output files
3. Maintain timestamped results for trend analysis
4. Use version control for scan configurations
5. Create summary reports for stakeholders

### 4. Validation and False Positive Management

1. Manually verify high-severity findings before reporting
2. Use multiple tools to confirm critical vulnerabilities
3. Document proof-of-concept for each confirmed finding
4. Track false positive rates for each tool
5. Adjust scan configurations to reduce false positives

### 5. Remediation Tracking

1. Create tickets for all identified vulnerabilities
2. Set SLAs based on severity levels
3. Track remediation progress over time
4. Re-scan to verify fixes
5. Maintain historical data for compliance reporting

### 6. Reporting Best Practices

1. Include executive summary for management
2. Provide technical details for remediation teams
3. Include proof-of-concept where appropriate
4. Add remediation recommendations
5. Provide references for each vulnerability
6. Include risk ratings with clear justification
